<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taskflow</title>

    <!--  favicon  -->
    <link rel="icon" type="image/x-icon" href="/images/check-list.png">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Urbanist:wght@300;400;600;700&display=swap" rel="stylesheet">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">

    <link rel="stylesheet" href="/css/style.css">
</head>
<body>

<div class="to-do-container glass">
    <h4 class="title text-center mb-4">
        <i class="bi bi-calendar-check"></i> Taskflow
    </h4>

    <!-- ── ADD form ──────────────────────────────────────────── -->
    <form class="d-flex gap-2 mb-4" th:action="@{/add}" method="post">
        <input type="text"
               name="title"
               class="form-control todo-input"
               placeholder="What needs to be done?"
               required>

        <button class="btn btn-add" type="submit">
            <i class="bi bi-plus-lg"></i>
        </button>
    </form>

    <!-- ── empty state ───────────────────────────────────────── -->
    <div th:if="${#lists.isEmpty(tasks)}" class="empty-state">
        <i class="bi bi-inbox"></i>
        <p>No tasks yet</p>
    </div>

    <!-- ── task list ─────────────────────────────────────────── -->
    <div class="todo-list">

        <div th:each="task : ${tasks}" class="todo-item">

            <!-- Status toggle  (POST form, no page-level wrapper needed) -->
            <form th:action="@{/update/{id}(id=${task.id})}" method="post" class="status-btn"
                  style="margin:0;padding:0;border:none;background:none;">
                <button type="submit" class="status-btn" aria-label="Toggle status"
                        style="border:none;background:none;cursor:pointer;padding:0;">
                    <i class="bi"
                       th:classappend="${task.status}
                           ? 'bi-check-circle-fill check-icon'
                           : 'bi-circle uncheck-icon'"></i>
                </button>
            </form>

            <!-- Task title -->
            <span th:text="${task.title}"
                  th:classappend="${task.status} ? 'done' : ''"
                  class="todo-text"></span>

            <!-- Delete (POST form) -->
            <form th:action="@{/delete/{id}(id=${task.id})}" method="post" class="delete-btn"
                  style="margin:0;padding:0;border:none;background:none;">
                <button type="submit" class="delete-btn" aria-label="Delete task"
                        style="border:none;background:none;cursor:pointer;padding:0;">
                    <i class="bi bi-trash3"></i>
                </button>
            </form>

        </div>

    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>